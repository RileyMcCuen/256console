(this.webpackJsonp256console=this.webpackJsonp256console||[]).push([[0],{105:function(e,t,n){e.exports=n(542)},110:function(e,t,n){},111:function(e,t,n){},43:function(e,t){},528:function(e,t){},530:function(e,t){},542:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),s=n(31),o=n.n(s),c=(n(110),n(18)),u=n(17),l=n(5),p=n(6),d=n(8),f=n(7),h=(n(111),n(33)),m=n(2),v=n.n(m),b=n(4),y=n(10),g=n(15),E=n.n(g),k="us-east-1",j="https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD";!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(a||(a={}));var w,O=null;!function(e){e[e.Bool=0]="Bool",e[e.Num=1]="Num",e[e.Str=2]="Str"}(w||(w={}));var T=function(){function e(t,n,a,r){Object(l.a)(this,e),this.name=void 0,this.prefix=void 0,this.metaDataKeyName=void 0,this.metaDataType=void 0,this.name=t,this.prefix=n,this.metaDataKeyName=a,this.metaDataType=r}return Object(p.a)(e,null,[{key:"getPrefixFromPK",value:function(t){return e.parsePrefixRegEx.exec(t)[1]}}]),Object(p.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getMetaDataKeyName",value:function(){return this.metaDataKeyName}},{key:"getMetaDataType",value:function(){return this.metaDataType}},{key:"toMetaDataFromData",value:function(e){return this.toMetaData(e[this.name])}},{key:"toMetaData",value:function(t){return e.parseDataRegEx.exec(t)[1]}},{key:"toString",value:function(e){return"#".concat(this.prefix,":").concat(e)}}]),e}();T.parsePrefixRegEx=/^#([a-zA-Z0-9_.]+):/,T.parseDataRegEx=/^#[a-zA-Z0-9_.]+:([a-zA-Z0-9_.]+)/;var S=function(){function e(t,n,a,r){if(Object(l.a)(this,e),this.name=void 0,this.prefix=void 0,this.metaDataKeyNames=void 0,this.metaDataTypes=void 0,!e.prefixRegEx.test(n))throw new Error("Prefix is only allowed to take format: /([a-zA-Z0-9_.]+)/.");this.name=t,this.prefix=n,this.metaDataKeyNames=a,this.metaDataTypes=r}return Object(p.a)(e,null,[{key:"getPrefixFromSK",value:function(t){return e.parsePrefixRegEx.exec(t)[1]}}]),Object(p.a)(e,[{key:"getName",value:function(){return this.name}},{key:"getMetaDataKeyNames",value:function(){return this.metaDataKeyNames}},{key:"getMetaDataTypes",value:function(){return this.metaDataTypes}},{key:"toMetaDataFromData",value:function(e){return this.toMetaData(e[this.name])}},{key:"toMetaData",value:function(e){var t=this;if("#"===e[0]){var n=(e=e.slice(1)).split(":");if(n.length-1===this.metaDataKeyNames.length){var a=[];return n.forEach((function(e,n){n>0&&a.push({key:t.metaDataKeyNames[n-1],value:e})})),a}throw new Error("Provided key does not have the expected number of values.")}throw new Error("Provided key does not follow expected pattern. Missing '#' at front of string.")}},{key:"toString",value:function(e){var t="#".concat(this.prefix);return this.metaDataKeyNames.forEach((function(n){var a=""+e[n];if(void 0===a||null===a)throw new Error("Provided object must have a non-null value for every key in sort key metaData. This object was missing at least this key: ".concat(n,"."));if(-1!==a.indexOf(":")||-1!==a.indexOf("#"))throw new Error("Sort Key meta data cannot include # or : in it. This will ruin the invariant that allows the parser to work.");t+=":".concat(a)})),t}}]),e}();S.prefixRegEx=/([a-zA-Z0-9_.]+)/,S.parsePrefixRegEx=/^#([a-zA-Z0-9_.]+):/;var N=function(){function e(){Object(l.a)(this,e)}return Object(p.a)(e,[{key:"convert",value:function(e,t){switch(t){case w.Str:return e;case w.Bool:return"true"===e.trim().toLowerCase();case w.Num:return Number(e)}}},{key:"construct",value:function(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n]})),this[this.primaryKey().getMetaDataKeyName()]=this.convert(this.primaryKey().toMetaDataFromData(e),this.primaryKey().getMetaDataType()),this.sortKey().toMetaDataFromData(e).forEach((function(e,n){t[e.key]=t.convert(e.value,t.sortKey().getMetaDataTypes()[n])}))}},{key:"toDBForm",value:function(){var e=this,t={};return Object.keys(this).forEach((function(n){e.sortKey().getMetaDataKeyNames().includes(n)||e.primaryKey().getMetaDataKeyName()===n||(t[n]=e[n])})),E.a.Converter.marshall(t)}}]),e}(),x=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e,n.Name,n.PKName,n.SKName)).addEntity(A).addEntity(C),a}return Object(p.a)(n,[{key:"deleteEntity",value:function(){var e=Object(b.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.delete(t.PKMeta,t.SKMeta));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEntity",value:function(){var e=Object(b.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.get(t.PKMeta,t.SKMeta));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getProjectNames",value:function(){var e=Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("PKMeta = :pk AND begins_with(SKMeta, :skp)",{":pk":C.PK,":skp":"#"+C.sortKeyPrefix});case 2:return e.abrupt("return",e.sent.map((function(e){return new C(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"incrementHITCount",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createLogEntry",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n,a,r,i){var s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=P.Create(t,n,a,r,i),e.next=3,this.put(s);case 3:return e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,a,r,i){return e.apply(this,arguments)}}()},{key:"getLogEntries",value:function(){var e=Object(b.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("PKMeta = :pk",{":pk":"#STUDENT:D"});case 2:return e.abrupt("return",e.sent.map((function(e){return new P(e)})).filter((function(e){return e.Key.includes(t)})).filter((function(e){return!e.Key.includes("riley.mccuen.t")})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(function(){function e(t,n,a,r){Object(l.a)(this,e),this.fetchClient=void 0,this.name=void 0,this.pkName=void 0,this.skName=void 0,this.entities=void 0,this.fetchClient=t,this.name=n,this.pkName=a,this.skName=r,this.entities=new Map}return Object(p.a)(e,[{key:"addEntity",value:function(e){var t=this.entities.get(e.primaryKeyPrefix);return void 0!==t&&null!==t||(t=new Map,this.entities.set(e.primaryKeyPrefix,t)),t.set(e.sortKeyPrefix,e),this}},{key:"getName",value:function(){return this.name}},{key:"getEntityConstructor",value:function(e,t){var n;return null===(n=this.entities.get(e))||void 0===n?void 0:n.get(t)}},{key:"getKeySchema",value:function(){return[{KeyType:"HASH",AttributeName:this.pkName},{KeyType:"RANGE",AttributeName:this.skName}]}},{key:"getAttributeDefinitions",value:function(){return[{AttributeName:this.pkName,AttributeType:"S"},{AttributeName:this.skName,AttributeType:"S"}]}},{key:"getKey",value:function(e,t){var n={};return n[this.pkName]=e,n[this.skName]=t,n}},{key:"fetchJSON",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchClient.fetch(t,n);case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"exists",value:function(){var e=Object(b.a)(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/db/tables",j+"/db/tables",t={method:a.GET,headers:{"Content-Type":"application/json"}},e.next=5,this.fetchJSON("https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD/db/tables",t);case 5:return n=e.sent,e.abrupt("return",-1!==n.TableNames.indexOf("cse-256-data"));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/db/table",j+"/db/table",n={method:a.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify({TableName:this.getName(),Item:t.toDBForm()})},e.abrupt("return",this.fetchJSON("https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD/db/table",n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n,a){var r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.delete(t,n);case 2:return r=e.sent,console.log(r),e.next=6,this.put(a);case 6:i=e.sent,console.log(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){var r,i,s,o;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/db/table/get-item",j+"/db/table/get-item",r=this.getKey(t,n),i={method:a.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify({TableName:this.getName(),Key:E.a.Converter.marshall(r)})},e.t0=E.a.Converter,e.next=7,this.fetchJSON("https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD/db/table/get-item",i);case 7:if(e.t1=e.sent.Item,void 0!==(s=e.t0.unmarshall.call(e.t0,e.t1))){e.next=11;break}return e.abrupt("return",s);case 11:return o=this.getEntityConstructor(T.getPrefixFromPK(s[this.pkName]),S.getPrefixFromSK(s[this.skName])),e.abrupt("return",new o(s));case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){var r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/db/table",j+"/db/table",r=this.getKey(t,n),i={method:a.DELETE,headers:{"Content-Type":"application/json"},body:JSON.stringify({TableName:this.getName(),Key:E.a.Converter.marshall(r)})},e.t0=console,e.next=7,this.fetchJSON("https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD/db/table",i);case 7:e.t1=e.sent,e.t0.log.call(e.t0,e.t1);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"query",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/db/table/query",j+"/db/table/query",r={method:a.POST,headers:{"Content-Type":"application/json"},body:JSON.stringify({TableName:this.getName(),KeyConditionExpression:t,ExpressionAttributeValues:E.a.Converter.marshall(n)})},e.next=5,this.fetchJSON("https://2ykopq1oha.execute-api.us-east-1.amazonaws.com/PROD/db/table/query",r);case 5:return e.abrupt("return",e.sent.Items.map((function(e){return E.a.Converter.unmarshall(e)})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}());x.Name="cse-256-data",x.PKName="PKMeta",x.SKName="SKMeta";var I=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).PKMeta=void 0,e.SKMeta=void 0,e}return n}(N),D=function e(t,n){Object(l.a)(this,e),this.tag=void 0,this.description=void 0,this.tag=t,this.description=n},C=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),e.ProjectName=n.ProjectName,(a=t.call(this)).ProjectName=void 0,a.Name=void 0,a.Tasks=void 0,a.parsedTags=void 0,a.construct(e),void 0===a.Tasks?a.parsedTags=[]:a.parsedTags=JSON.parse(a.Tasks).map((function(e){return new D(e.tag,e.description)})),a}return Object(p.a)(n,[{key:"primaryKey",value:function(){return n.primaryKey}},{key:"sortKey",value:function(){return n.sortKey}},{key:"sortKeyPrefix",get:function(){return n.sortKeyPrefix}}],[{key:"Create",value:function(e,t){return""===t&&(t="[]"),new n({PKMeta:n.PK,SKMeta:this.sortKey.toString({Name:e}),Tasks:t})}}]),n}(I);C.ProjectName="ProjectName",C.primaryKeyPrefix="CLASS",C.sortKeyPrefix="PROJECT_NAME",C.PK="#"+C.primaryKeyPrefix+":"+C.ProjectName,C.primaryKey=new T(x.PKName,C.primaryKeyPrefix,C.ProjectName,w.Str),C.sortKey=new S(x.SKName,C.sortKeyPrefix,["Name"],[w.Str]);var A=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this)).WUSTLKey=void 0,a.ProjectName=void 0,a.Iteration=void 0,a.HITName=void 0,a.Cnt=void 0,a.AWSIDs=void 0,a.construct(e),a}return Object(p.a)(n,[{key:"primaryKey",value:function(){return n.primaryKey}},{key:"sortKey",value:function(){return n.sortKey}},{key:"sortKeyPrefix",get:function(){return n.sortKeyPrefix}}],[{key:"Create",value:function(e,t,a,r,i,s){return new n({PKMeta:this.primaryKey.toString(e),SKMeta:this.sortKey.toString({ProjectName:t,Iteration:a,HITName:r}),Cnt:i,AWSIDs:s})}}]),n}(I);A.primaryKeyPrefix="STUDENT",A.sortKeyPrefix="HIT",A.primaryKey=new T(x.PKName,A.primaryKeyPrefix,"WUSTLKey",w.Str),A.sortKey=new S(x.SKName,A.sortKeyPrefix,["ProjectName","Iteration","HITName"],[w.Str,w.Num,w.Str]);var P=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this)).PKD=void 0,a.HITID=void 0,a.AssignmentID=void 0,a.WorkerID=void 0,a.Key=void 0,a.TimeOfSubmission=void 0,a.construct(e),a}return Object(p.a)(n,[{key:"primaryKey",value:function(){return n.primaryKey}},{key:"sortKey",value:function(){return n.sortKey}},{key:"keyFileNamePair",value:function(){var e=this.Key.split("/");if(5===e.length){var t=e[0],n=e[3],a=e[4];return{key:this.Key,fileName:t+"_"+n+"_"+a}}return{key:this.Key,fileName:this.Key}}},{key:"sortKeyPrefix",get:function(){return n.sortKeyPrefix}}],[{key:"Create",value:function(e,t,a,r,i){return new n({PKMeta:this.primaryKey.toString(n.dummyPrimaryKey),SKMeta:this.sortKey.toString({HITID:e,AssignmentID:t,WorkerID:a}),Key:r,TimeOfSubmission:i})}}]),n}(I);P.primaryKeyPrefix="STUDENT",P.sortKeyPrefix="LOG",P.dummyPrimaryKey="D",P.primaryKey=new T(x.PKName,P.primaryKeyPrefix,"PKD",w.Str),P.sortKey=new S(x.SKName,P.sortKeyPrefix,["HITID","AssignmentID","WorkerID"],[w.Str,w.Str,w.Str]);var K,R=n(55),M=n(34),U=n.n(M),H=new(function(){function e(){Object(l.a)(this,e),this.accts={},this.sandboxAccts={},this.realAccts={}}return Object(p.a)(e,[{key:"add",value:function(e,t,n){this.addRealAccount(e,new U.a.MTurk({region:k,endpoint:"https://mturk-requester.us-east-1.amazonaws.com",credentials:{accessKeyId:t,secretAccessKey:n}})),this.addSandboxAccount(e,new U.a.MTurk({region:k,endpoint:"https://mturk-requester-sandbox.us-east-1.amazonaws.com",credentials:{accessKeyId:t,secretAccessKey:n}}))}},{key:"addRealAccount",value:function(e,t){this.realAccts[e]=t}},{key:"addSandboxAccount",value:function(e,t){this.sandboxAccts[e]=t}},{key:"setSandbox",value:function(e){e===G.SANDBOX?this.accts=this.sandboxAccts:this.accts=this.realAccts}},{key:"forp",value:function(e){var t=this;return Object.keys(this.accts).map((function(n){return e(n,t.accts[n])}))}},{key:"getAccountBalance",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n.getAccountBalance((function(n,a){e(n?{wustlKey:t,balance:"Not Available."}:{wustlKey:t,balance:a.AvailableBalance?a.AvailableBalance:"Not Available."})}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getAccountBalances",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setSandbox(t),e.abrupt("return",this.forp(function(){var e=Object(b.a)(v.a.mark((function e(t,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.getAccountBalance(t,a));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadHit",value:function(){var e=Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadHits",value:function(){var t=Object(b.a)(v.a.mark((function t(n,a,r){var i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setSandbox(a),t.next=3,H.createAndGetDisqualifiers(r);case 3:return i=t.sent,t.abrupt("return",this.forp(function(){var t=Object(b.a)(v.a.mark((function t(a,r){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,s){var o=n[a],c=i[a];c&&o&&o.forEach(function(){var n=Object(b.a)(v.a.mark((function n(i){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i.count>0&&setTimeout(Object(b.a)(v.a.mark((function n(){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.createHIT({AssignmentDurationInSeconds:360,AutoApprovalDelayInSeconds:2592e3,Description:"You will be given a scenario for a website user. Please navigate through the website to find the answer - your path is tracked as you work. When you are on the page with the answer, fill out the text box in the drop down at the top of the page and click submit. Correct answers will receive bonuses of up to $.25.",LifetimeInSeconds:72e3,MaxAssignments:i.count,Reward:i.price,Title:"Information Foraging WUSTL",Question:e.HitConfig(i.url),QualificationRequirements:[{ActionsGuarded:"DiscoverPreviewAndAccept",Comparator:"DoesNotExist",IntegerValues:[1],QualificationTypeId:c}]},function(){var e=Object(b.a)(v.a.mark((function e(n,i){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}console.log("ERROR: "+n),t({wustlKey:a,error:n.name,code:n.code,message:n.message}),e.next=13;break;case 5:return console.log("DATA: "+i),e.t0=t,e.t1=a,e.next=10,r.getAccountBalance().promise();case 10:e.t2=e.sent.AvailableBalance,e.t3={wustlKey:e.t1,balance:e.t2},(0,e.t0)(e.t3);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return n.stop()}}),n)}))),100);case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 5:case"end":return t.stop()}}),t,this)})));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"cancelHits",value:function(){var e=Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.forp(function(){var e=Object(b.a)(v.a.mark((function e(t,n){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(b.a)(v.a.mark((function e(t,a){var r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.listHITs().promise();case 2:i=e.sent,null===(r=i.HITs)||void 0===r||r.forEach((function(e){setTimeout((function(){n.updateExpirationForHIT({ExpireAt:new Date,HITId:e.HITId},(function(e,t){e?console.log("ERROR: "+e):console.log("DATA: "+t)}))}),100)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"payHits",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n,a,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<t.values.length)){e.next=44;break}if(a=t.values[n],r=this.accts[a[0]],i=void 0,e.prev=5,void 0==r){e.next=34;break}e.t0=a[3],e.next="approve"===e.t0?10:"reject"===e.t0?15:"bonus"===e.t0?20:29;break;case 10:return e.next=12,r.approveAssignment({AssignmentId:a[2]}).promise();case 12:return i=e.sent,console.log(i.$response),e.abrupt("break",32);case 15:return e.next=17,r.rejectAssignment({AssignmentId:a[2],RequesterFeedback:"The log of your actions on the website and the written response did not show substantial effort in completing this task and therefore do not warrant payment."}).promise();case 17:return i=e.sent,console.log(i.$response),e.abrupt("break",32);case 20:return e.next=22,r.approveAssignment({AssignmentId:a[2]}).promise();case 22:return i=e.sent,console.log(i.$response),e.next=26,r.sendBonus({AssignmentId:a[2],WorkerId:a[1],BonusAmount:"0.10",Reason:"Your work showed an honest effort to complete the task and you either found the correct answer or put in strong logical thought in your actions. Thank your for your time, and we hope this bonus makes the HIT feel more worthwhile.",UniqueRequestToken:""}).promise();case 26:return i=e.sent,console.log(i.$response),e.abrupt("break",32);case 29:return console.log(a),console.log("^^ the above row did not contain a valid action ^^"),e.abrupt("break",32);case 32:e.next=36;break;case 34:console.log(a),console.log("^^ row was undefined ^^");case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(5),console.log(e.t1);case 41:n++,e.next=1;break;case 44:case"end":return e.stop()}}),e,this,[[5,38]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getStatuses",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n,a,r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setSandbox(t),n=new B(["WUSTL Key","Awaiting Acceptance","In Progress","Completed"],[]),!(a=this.forp(function(){var e=Object(b.a)(v.a.mark((function e(t,a){var r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[t,0,0,0],e.next=3,a.listHITs().promise();case 3:return(i=e.sent.HITs)&&i.length>0&&(i.map((function(e){return e.MaxAssignments?e.MaxAssignments:0})).reduce((function(e,t){return e+t}),0),i.forEach((function(e){var t=e.NumberOfAssignmentsAvailable?e.NumberOfAssignmentsAvailable:0,n=e.NumberOfAssignmentsPending?e.NumberOfAssignmentsPending:0,a=e.MaxAssignments?e.MaxAssignments:0;switch(a-=t+n,a=Math.max(a,0),e.HITStatus){case"Assignable":r[1]+=t;break;case"Unassignable":r[2]+=n;break;case"Reviewable":r[3]+=a}}))),s=r.map((function(e){return e+""})),n.values.push(s),e.abrupt("return",!0);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))){e.next=21;break}r=Object(R.a)(a),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return s=i.value,e.next=11,s;case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createAndGetDisqualifiers",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},this.forp(function(){var e=Object(b.a)(v.a.mark((function e(a,r){var i,s,o,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.listQualificationTypes().promise();case 2:if(s=e.sent,o="",null===(i=s.QualificationTypes)||void 0===i||i.forEach((function(e){e.Name===t&&e.QualificationTypeId&&(o=e.QualificationTypeId)})),""!==o){e.next=10;break}return e.next=8,r.createQualificationType({Name:t,Description:"This qualification is applied to anyone who has completed an information foraging task from the WUSTL Nursery School HITs.",AutoGranted:!1,QualificationTypeStatus:"Active"}).promise();case 8:u=e.sent,(null===(c=u.QualificationType)||void 0===c?void 0:c.QualificationTypeId)&&(n[a]=u.QualificationType.QualificationTypeId);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disqualify",value:function(){var e=Object(b.a)(v.a.mark((function e(t,n){var a,r,i,s,o,c,u,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createAndGetDisqualifiers(t);case 2:for(i in a=e.sent,r=Array.from(n),this.accts)if(s=this.accts[i],o=a[i],s&&o){c=Object(R.a)(r);try{for(c.s();!(u=c.n()).done;)l=u.value,s.associateQualificationWithWorker({IntegerValue:1,QualificationTypeId:o,SendNotification:!1,WorkerId:l})}catch(p){c.e(p)}finally{c.f()}}case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"HitConfig",value:function(e){return'<?xml version="1.0" encoding="UTF-8"?>\n                    <ExternalQuestion xmlns="http://mechanicalturk.amazonaws.com/AWSMechanicalTurkDataSchemas/2006-07-14/ExternalQuestion.xsd">\n                        <ExternalURL>'.concat(e,"</ExternalURL>\n                        <FrameHeight>0</FrameHeight>\n                    </ExternalQuestion>")}}]),e}()),L=H;!function(e){e[e.Unknown=0]="Unknown",e[e.Created=1]="Created",e[e.DoesNotExist=2]="DoesNotExist"}(K||(K={}));var F;!function(e){e[e.COUNT_GIVEN=0]="COUNT_GIVEN",e[e.COUNT_NOT_GIVEN=1]="COUNT_NOT_GIVEN"}(F||(F={}));var _,G,B=function(){function e(t,n){Object(l.a)(this,e),this.header=void 0,this.values=void 0,this.header=t,this.values=n}return Object(p.a)(e,[{key:"indexOfHeader",value:function(e){return this.header.indexOf(e)}},{key:"findFirstEntry",value:function(e){return this.values.find((function(t){return e.every((function(e){return t[e.index]===e.expectedValue}))}))}},{key:"resetValues",value:function(){return this.values=[],this}}]),e}();!function(e){e[e.UNATTEMPTED=0]="UNATTEMPTED",e[e.FAILED=1]="FAILED",e[e.SUCCEEDED=2]="SUCCEEDED"}(_||(_={})),function(e){e[e.SANDBOX=0]="SANDBOX",e[e.REAL=1]="REAL"}(G||(G={}));var q=function(){return{type:"LOGIN",loggedIn:_.SUCCEEDED}},W=function(){return{type:"LOGOUT",loggedIn:_.FAILED}},V=function(e){var t=e.sort((function(e,t){return e.Name<t.Name?-1:1}));return{type:"UPDATE_PROJECTS",projects:t,currentProject:t[0]?t[0]:C.Create("No Projects Yet","")}},z=function(e){return{type:"UPDATE_SPI_DATA",spiData:e}},J=function(e){return e.forEach((function(e){L.add(e.wustlKey,e.id,e.secret)})),{type:"UPDATE_STUDENTS",students:e}},Q=function(e){return{type:"UPDATE_MTURK_MODE",mturkMode:e}},Y=function(){return function(){var e=Object(b.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t(z({}))}catch(n){console.log(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},X=function(e){return function(){var t=Object(b.a)(v.a.mark((function t(n){var a;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=Promise,t.next=4,L.getAccountBalances(e);case 4:return t.t1=t.sent,t.next=7,t.t0.all.call(t.t0,t.t1);case 7:a=t.sent,console.log(a),n({type:"UPDATE_BALANCES",accountBalances:a}),t.next=15;break;case 12:t.prev=12,t.t2=t.catch(0),console.log(t.t2);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()},Z={updateDBStatus:function(e){return{type:"UPDATE_DB_STATUS",dbStatus:e}}},$=Object(y.b)((function(e){return{dbStatus:e.dbStatus}}),Z)(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderCheck",value:function(){var e=this;return i.a.createElement("button",{className:"status-update safe right",onClick:Object(b.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e.props,t.next=3,null===O||void 0===O?void 0:O.exists;case 3:if(!t.sent){t.next=7;break}t.t1=K.Created,t.next=8;break;case 7:t.t1=K.DoesNotExist;case 8:t.t2=t.t1,t.t0.updateDBStatus.call(t.t0,t.t2);case 10:case"end":return t.stop()}}),t)})))},"Check")}},{key:"status",value:function(){switch(this.props.dbStatus){case K.Unknown:return"The status is currently unknown. Would you like to check?";case K.Created:return"The database is created and awaiting requests.";case K.DoesNotExist:return"The database does not exist. You should initialize it if you would like to use it."}}},{key:"render",value:function(){return i.a.createElement("div",{className:"status-container"},this.renderCheck(),i.a.createElement("h2",null,"Database Status:"),i.a.createElement("p",{className:"status"},this.status()))}}]),n}(i.a.Component)),ee={updateCurrentProject:function(e){return{type:"UPDATE_CURRENT_PROJECT",currentProject:e}},updateCurrentIteration:function(e){return{type:"UPDATE_CURRENT_ITERATION",currentIteration:e}}},te=Object(y.b)((function(e){return{projects:e.projects,iterations:e.iterations,currentProject:e.currentProject,currentIteration:e.currentIteration}}),ee),ne=te(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"project-iteration-selector"},i.a.createElement("div",{className:"project-iteration-description"},"Project Name: Iteration"),i.a.createElement("div",null,i.a.createElement("select",{className:"project-selector",onChange:function(t){return e.props.updateCurrentProject(e.props.projects[t.target.selectedIndex])},defaultValue:this.props.currentProject.Name},this.props.projects.map((function(e,t){return i.a.createElement("option",{key:e.Name,value:e.Name},e.Name)}))),i.a.createElement("span",{className:"separator"},":"),i.a.createElement("select",{className:"iteration-selector",onChange:function(t){return e.props.updateCurrentIteration(parseInt(t.target.value))},defaultValue:this.props.currentIteration},function(e,t){for(var n=[],a=0;a<e;a++)n.push(t(a));return n}(this.props.iterations,(function(e){return i.a.createElement("option",{key:e,value:e},e)})))))}}]),n}(i.a.Component)),ae=n(22),re={loggedIn:_.UNATTEMPTED,dbStatus:K.Unknown,projects:[],iterations:4,currentProject:C.Create("",""),currentIteration:0,spiData:null,students:[],accountBalances:[],submitHITData:{dataType:F.COUNT_NOT_GIVEN,data:new B([],[])},mturkMode:G.SANDBOX};var ie=n(99),se=Object(ae.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.assign({},e,t)};switch(t.type){case"LOGIN":var a=t;return n({loggedIn:a.loggedIn});case"LOGOUT":var r=t;return n({loggedIn:r.loggedIn});case"UPDATE_DB_STATUS":var i=t;return n({dbStatus:i.dbStatus});case"UPDATE_PROJECTS":var s=t;return n({projects:s.projects,currentProject:s.currentProject});case"UPDATE_ITERATIONS":var o=t;return n({iterations:o.iterations,currentIteration:o.iteration});case"UPDATE_CURRENT_PROJECT":var c=t;return n({currentProject:c.currentProject});case"UPDATE_CURRENT_ITERATION":var u=t;return n({currentIteration:u.currentIteration});case"UPDATE_SPI_DATA":var l=t;return n({spiData:l.spiData});case"UPDATE_STUDENTS":var p=t;return n({students:p.students});case"UPDATE_BALANCES":var d=t;return n({accountBalances:d.accountBalances});case"UPDATE_SUBMIT_HIT_DATA":var f=t;return console.log(f),n({submitHITData:f.submitHITData});case"UPDATE_MTURK_MODE":var h=t;return n({mturkMode:h.mturkMode});default:return e}}),Object(ae.c)(Object(ae.a)(ie.a))),oe=n(100),ce={updateProjects:V},ue=Object(y.b)((function(e){return{projects:e.projects}}),ce),le=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).inputElem=i.a.createRef(),a.tagInputElem=i.a.createRef(),a.state={selected:!1,editing:!1,val:e.project.Name},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("li",{className:this.props.selected?"update-project selected":"update-project",onClick:function(t){t.stopPropagation(),e.props.select((function(){}))}},i.a.createElement("div",{className:"project-name"},i.a.createElement("input",{type:"text",value:this.state.val,disabled:!this.state.editing,ref:this.inputElem,onChange:function(t){return e.setState({val:t.target.value})}}),i.a.createElement("button",{className:"danger",onClick:function(){return e.props.delete()}},"Delete"),i.a.createElement("button",{disabled:this.state.editing,onClick:function(){e.setState({editing:!0},(function(){var t;return null===(t=e.inputElem.current)||void 0===t?void 0:t.focus()}))}},"Edit"),i.a.createElement("button",{disabled:!this.state.editing,onClick:function(){e.props.update(C.Create(e.state.val,e.props.project.Tasks)),e.setState({editing:!1})}},"Save"),i.a.createElement("button",{disabled:!this.state.editing,onClick:function(){e.setState({val:e.props.project.Name,editing:!1})}},"Cancel")),i.a.createElement("div",{className:this.props.selected?"project-tags":"hide"},i.a.createElement(oe.FileDrop,{className:"file-drop",onDrop:function(t){if(null!==t)if(1===t.length)try{var n=new FileReader;n.addEventListener("loadend",(function(t){try{var a=JSON.parse(n.result);if(Array.isArray(a))if(a.every((function(e){return"context"in e&&"question"in e&&"tag"in e}))){var r=JSON.stringify(a.map((function(e){return{tag:e.tag,description:e.context+e.question}})));e.props.update(C.Create(e.props.project.Name,r))}else alert("Elements in array do not conform to specification.");else alert("Input JSON document should be an array at the top level.")}catch(t){console.log(t),alert(t)}})),n.readAsText(t[0])}catch(a){console.log(a),alert(a)}else alert("Only input exactly one file into the drag and drop function.");else alert("Please put an actual file into the drop zone.")}},"Drop json file with scenario context here!")),i.a.createElement("ul",null,this.props.project.parsedTags.map((function(e,t){return i.a.createElement("li",{key:e.tag+e.description},i.a.createElement("h3",null," ",e.tag," "),i.a.createElement("p",null,e.description))}))))}}]),n}(i.a.Component),pe=ue(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).newInput=i.a.createRef(),a.state={selected:0},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"status-container",onClick:function(){e.setState({selected:-1})}},i.a.createElement("h2",null,"Current Projects:"),i.a.createElement("ul",{className:"projects"},this.props.projects.map((function(t,n){return i.a.createElement(le,{project:t,selected:n===e.state.selected,delete:function(){se.dispatch(function(){var n=Object(b.a)(v.a.mark((function n(a){var r,i;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.Name,i=C.Create(r,t.Tasks),n.prev=2,n.next=5,null===O||void 0===O?void 0:O.deleteEntity(i);case 5:a(e.props.updateProjects(e.props.projects.filter((function(e){return e.Name!==i.Name})))),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),alert("Could not delete project. Send error output to Riley or debug: ".concat(n.t0,"."));case 11:case"end":return n.stop()}}),n,null,[[2,8]])})));return function(e){return n.apply(this,arguments)}}())},update:function(n){se.dispatch(function(){var a=Object(b.a)(v.a.mark((function a(r){var i;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t.parsedTags,t.Name!==n.Name||i.length!==n.parsedTags.length){a.next=3;break}return a.abrupt("return");case 3:return a.prev=3,a.next=6,null===O||void 0===O?void 0:O.deleteEntity(t);case 6:return a.next=8,null===O||void 0===O?void 0:O.put(n);case 8:r(e.props.updateProjects([].concat(Object(u.a)(e.props.projects.filter((function(e){return e.Name!==n.Name}))),[n]))),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(3),alert("Could not update project. Send error output to Riley or debug: ".concat(a.t0,"."));case 14:case"end":return a.stop()}}),a,null,[[3,11]])})));return function(e){return a.apply(this,arguments)}}())},select:function(t){e.setState({selected:n},t)},key:t.Name})})),i.a.createElement("li",null,i.a.createElement("input",{ref:this.newInput,type:"text",placeholder:"New Project Name..."}),i.a.createElement("button",{onClick:function(){se.dispatch(function(){var t=Object(b.a)(v.a.mark((function t(n){var a;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.newInput.current||""===e.newInput.current.value.trim()){t.next=12;break}return t.prev=1,a=C.Create(e.newInput.current.value,""),t.next=5,null===O||void 0===O?void 0:O.put(a);case 5:n(e.props.updateProjects([].concat(Object(u.a)(e.props.projects),[a]))),e.newInput.current.value="",t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),alert("Could not add project. Send error output to Riley or debug: ".concat(t.t0,"."));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}())}},"Add"))))}}]),n}(i.a.Component)),de=n(44),fe={updateSPIData:z,updateSubmitHITData:function(e){return{type:"UPDATE_SUBMIT_HIT_DATA",submitHITData:e}}},he=Object(y.b)((function(e){return{currentProject:e.currentProject,currentIteration:e.currentIteration,spiData:e.spiData,students:e.students,submitHITData:e.submitHITData}}),fe);var me=function(){function e(){Object(l.a)(this,e),this.data=void 0,this.filterExpr=void 0,this.data=null,this.filterExpr=null}return Object(p.a)(e,[{key:"setData",value:function(e){return this.data=e,this}},{key:"setFilterExpression",value:function(e){return this.filterExpr=e,this}},{key:"lex",value:function(){if(null===this.filterExpr)throw new Error("filter expression has not been set yet, therefore lex cannot be called yet");return this.filterExpr.trim().split(" ").map((function(e){return e.trim()})).filter((function(e){return""!==e}))}},{key:"key",value:function(e){if(null===this.data)throw new Error("data has not been set yet, therefore key cannot be called yet");if("&&"===e||"=="===e)throw new Error("invalid key supplied (special symbol was provided instead of a key)");var t=this.data.header.indexOf(e);if(console.log(e,t),-1===t)throw new Error("invalid key supplied");return t}},{key:"eq",value:function(e){if("=="!==e)throw new Error("invalid equality detected")}},{key:"value",value:function(e){if("&&"===e||"=="===e)throw new Error("invalid value supplied (special symbol was provided instead of a value)");return e}},{key:"amper",value:function(e){if("&&"!==e)throw new Error("invalid expression connector detected")}},{key:"parse",value:function(e){var t=this;if(e.length<3)throw new Error("cannot parse expression with less than 3 tokens");if(e.length%2!==1)throw new Error("cannot parse expression with even number of tokens");var n=[],a=-1,r="";return e.forEach((function(e,i){switch(i%4){case 0:a=t.key(e);break;case 1:t.eq(e);break;case 2:r=t.value(e),n.push((s=a,o=r,function(e){return e[s]===o}));break;case 3:t.amper(e);break;default:throw new Error("i dont know how i got here, and should not have")}var s,o})),n}},{key:"evaluate",value:function(e){if(null===this.data)throw new Error("data is null, cannot evaluate a an expression without any data");return this.data.values.filter((function(t){return e.map((function(e){return e(t)})).every((function(e){return e}))}))}},{key:"execute",value:function(){return this.evaluate(this.parse(this.lex()))}}],[{key:"I",value:function(){return e.instance}}]),e}();me.instance=new me;var ve=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).fileInput=i.a.createRef(),a.state={input:"",displayTable:!1,compiler:(new me).setData(a.props.submitHITData.data)},a}return Object(p.a)(n,[{key:"updateCSVData",value:function(e){var t=[],n=[];try{e.length>=2&&(t=e[0],n=e.slice(1))}catch(a){alert(a),t=[],n=[]}3===t.length&&["WUSTL Key","Task Tag","Count"].every((function(e){return t.includes(e)}))?this.props.updateSubmitHITData({dataType:F.COUNT_GIVEN,data:new B(t,n)}):4===t.length&&["WUSTL Key","Task 1","Task 2","Task 3"].every((function(e){return t.includes(e)}))?this.props.updateSubmitHITData({dataType:F.COUNT_NOT_GIVEN,data:new B(t,n)}):alert("CSV is in invalid format. Cannot load the given file.")}},{key:"renderFileInput",value:function(){var e=this;return i.a.createElement("form",null,i.a.createElement("input",{ref:this.fileInput,type:"file",accept:"text/csv",className:"input-file",name:"csv-input",id:"csv-input",onChange:function(t){var n,a=null===(n=t.target.files)||void 0===n?void 0:n.item(0);if(a){var r=new FileReader;r.onloadend=function(){r.readyState===FileReader.DONE&&de(r.result,{},(function(t,n){t?alert("Could not parse file correctly. Error: ".concat(t,".")):e.updateCSVData(n)}))},r.readAsText(a,"utf-8")}}}),i.a.createElement("label",{className:"csv-input",htmlFor:"csv-input"},"Input File of HIT Assignments here..."))}},{key:"render",value:function(){var e=this,t=[];console.log(this.props.submitHITData),console.log(this.props.submitHITData.data),console.log(this.props.submitHITData.dataType);try{t=this.state.compiler.setData(this.props.submitHITData.data).execute()}catch(n){t=this.props.submitHITData.data.values}return i.a.createElement("div",{className:"status-container"},this.renderFileInput(),i.a.createElement("input",{type:"text",value:this.state.input,className:"filter-input",onChange:function(t){e.state.compiler.setFilterExpression(t.target.value),e.setState({input:t.target.value})},placeholder:"Enter your data filter expression here..."}),i.a.createElement(be,{data:new B(this.props.submitHITData.data.header,t)}))}}]),n}(i.a.Component),be=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return void 0===this.props.data||null===this.props.data||0===this.props.data.header.length?i.a.createElement("div",null,i.a.createElement("h2",null," No data to display. ")):i.a.createElement("table",{className:"hit-data"},i.a.createElement("thead",null,i.a.createElement("tr",null,this.props.data.header.map((function(e,t){return i.a.createElement("th",{key:e+t},e)})))),i.a.createElement("tbody",null,this.props.data.values.map((function(e,t){return i.a.createElement("tr",{key:t},e.map((function(e,t){return i.a.createElement("td",{key:e+t},e)})))}))))}}]),n}(i.a.Component),ye=he(ve),ge=n(35),Ee=n(102),ke=n(34),je="us-east-1:b69d4b85-5cd8-4a07-aabf-e730ede479d9";ke.config.region=k,ke.config.credentials=new ke.CognitoIdentityCredentials({IdentityPoolId:je});var we,Oe=new ge.c({UserPoolId:"us-east-1_B4YHaKqVR",ClientId:"15f397ambvh0db4i20usm454a0"}),Te=Oe.getCurrentUser(),Se=null,Ne=function(e){ke.config.credentials=new ke.CognitoIdentityCredentials({IdentityPoolId:je,Logins:Object(c.a)({},"cognito-idp.".concat(k,".amazonaws.com/").concat("us-east-1_B4YHaKqVR"),e.getIdToken().getJwtToken())})},xe=function(){var e=Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){ke.config.credentials.refresh((function(n){n&&t(n),Se=new Ee.AwsClient({secretAccessKey:ke.config.credentials.secretAccessKey,accessKeyId:ke.config.credentials.accessKeyId,sessionToken:ke.config.credentials.sessionToken}),ke.config.credentials.expired,e(!0)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){if(null===Se)throw new Error("AWS Fetch Client is null, cannot construct database connection.");!function(e){O=new x(e)}(Se)},De=function(){se.dispatch(function(){var e=Object(b.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.getProjectNames();case 3:n=e.sent,console.log(n),t(V(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),se.dispatch(Y())},Ce=function(){Te=null,null,Se=null},Ae=function(){Te=null,null},Pe=function(){var e=Object(b.a)(v.a.mark((function e(t,n){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t||""===n){e.next=9;break}return console.log(Te),null===Te&&(Te=new ge.b({Username:t,Pool:Oe})),a=new ge.a({Username:t,Password:n}),e.next=6,new Promise((function(e,t){var r;null===(r=Te)||void 0===r||r.authenticateUser(a,{onSuccess:function(){var n=Object(b.a)(v.a.mark((function n(a){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,Ne(a),n.next=4,xe();case 4:Ie(),De(),e(!0),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),Ae(),t(n.t0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}(),onFailure:function(e){Ae(),t(e)},newPasswordRequired:function(a,r){var i;return null===(i=Te)||void 0===i?void 0:i.completeNewPasswordChallenge(n,r,{onSuccess:function(t){t,e(!0)},onFailure:function(e){Ae(),t(e)}})}})}));case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,new Promise((function(e,t){null!==Te?Te.getSession(function(){var n=Object(b.a)(v.a.mark((function n(a,r){return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=17;break}return n.prev=1,Ne(r),n.next=5,xe();case 5:Ie(),De(),e(!0),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),Ae(),console.log(n.t0),t(n.t0);case 15:n.next=19;break;case 17:Ae(),t(a);case 19:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e,t){return n.apply(this,arguments)}}()):(Ae(),t("No user session."))}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Te){e.next=4;break}return e.next=3,new Promise((function(e,t){try{var n;null===(n=Te)||void 0===n||n.signOut(),Ce(),e(!0)}catch(a){Ce(),t(a)}}));case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Object(b.a)(v.a.mark((function e(t,n){var r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=j+"/logs?project=".concat(t,"&iteration=").concat(n),e.next=3,Se.fetch(r,{method:a.GET,headers:{"Content-Type":"application/json"}});case 3:return i=e.sent,e.abrupt("return",i.json());case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Me={login:q,logout:W},Ue=Object(y.b)((function(e){return{}}),Me),He=Ue(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).usernameField=i.a.createRef(),e.passwordField=i.a.createRef(),e}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{id:"login-container"},i.a.createElement("form",{onSubmit:function(){var t=Object(b.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!e.usernameField.current||!e.passwordField.current){t.next=6;break}return t.next=4,Pe(e.usernameField.current.value,e.passwordField.current.value);case 4:t.sent&&e.props.login();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},i.a.createElement("h1",null,"CSE 256 Console"),i.a.createElement("fieldset",null,i.a.createElement("label",null,"Username:"),i.a.createElement("input",{type:"text",placeholder:"Username...",ref:this.usernameField,autoComplete:"username"})),i.a.createElement("fieldset",null,i.a.createElement("label",null,"Password:"),i.a.createElement("input",{type:"password",placeholder:"Password...",ref:this.passwordField,autoComplete:"current-password"})),i.a.createElement("button",{className:"basic",type:"submit"}," Login ")))}}]),n}(i.a.Component)),Le=Ue(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("button",{className:"safe",onClick:Object(b.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ke();case 2:if(!t.sent){t.next=4;break}e.props.logout();case 4:case"end":return t.stop()}}),t)})))}," Logout ")}}]),n}(i.a.Component)),Fe=n(103),_e=n.n(Fe),Ge=n(57),Be=n(104);!function(e){e[e.FRESH=0]="FRESH",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.ERROR=3]="ERROR"}(we||(we={}));var qe=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={display:!1},a}return Object(p.a)(n,[{key:"loading",value:function(){switch(this.props.loadingState){case we.FRESH:return i.a.createElement(Be.FaQuestion,{fontSize:n.size});case we.LOADING:return i.a.createElement(_e.a,{color:"grey",type:"spin",height:n.size,width:n.size});case we.SUCCESS:return i.a.createElement(Ge.FcCheckmark,{fontSize:n.size});case we.ERROR:return i.a.createElement(Ge.FcCancel,{fontSize:n.size})}}},{key:"render",value:function(){var e=this;return this.props.display?i.a.createElement("div",{className:"button-with-description"},i.a.createElement("div",{className:"button-container"},i.a.createElement("button",{onClick:this.props.onClick,className:this.props.buttonClass},this.props.buttonTitle),i.a.createElement("span",null,this.loading()),i.a.createElement("button",{className:"info",onClick:function(){return e.setState({display:!e.state.display})}},"Info")),i.a.createElement("div",{className:this.state.display?"action-description":"action-description hide"},i.a.createElement("div",null,this.props.description),i.a.createElement("hr",null),i.a.createElement("h2",null," Errors: "),i.a.createElement("div",null,this.props.error?this.props.error:"There were no errors."))):null}}]),n}(i.a.Component);qe.size=38;var We,Ve=n(44),ze={updateStudents:J},Je=Object(y.b)((function(e){return{students:e.students}}),ze);!function(e){e.NO_UPLOAD="No file has been uploaded yet.",e.SUCCESS="File has been successfully uploaded and parsed.",e.FAILURE="The file that was uploaded could not be parsed or did not validate."}(We||(We={}));var Qe,Ye=Je(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={fileUploaded:We.NO_UPLOAD},a}return Object(p.a)(n,[{key:"validateStudents",value:function(e){return e.length>1&&"WUSTL Key"===e[0][0].trim()&&"GH Pages URL"===e[0][1].trim()&&"AWS IAM ID"===e[0][2].trim()&&"AWS IAM SECRET"===e[0][3].trim()&&e.every((function(e){return 4===e.length}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"student-file-input"},i.a.createElement("div",null,i.a.createElement("h3",null,this.state.fileUploaded),i.a.createElement(Xe,{onFileChange:function(t){e.validateStudents(t)?(e.props.updateStudents(t.slice(1).map((function(e){return{wustlKey:e[0].trim(),url:e[1].trim(),id:e[2].trim(),secret:e[3].trim()}}))),e.setState({fileUploaded:We.SUCCESS})):e.setState({fileUploaded:We.FAILURE})}})))}}]),n}(i.a.Component)),Xe=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).fileInput=i.a.createRef(),e}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("form",null,i.a.createElement("input",{ref:this.fileInput,type:"file",accept:"text/csv",className:"input-file",name:"student-input",id:"student-input",onChange:function(t){var n,a=null===(n=t.target.files)||void 0===n?void 0:n.item(0);if(a){var r=new FileReader;r.onloadend=function(){r.readyState===FileReader.DONE&&Ve(r.result,{},(function(t,n){t?alert("Could not parse file correctly. Error: ".concat(t,".")):(console.log(n),e.props.onFileChange(n))}))},r.readAsText(a,"utf-8")}}}),i.a.createElement("label",{className:"student-input",htmlFor:"student-input"},"Input File of Student Credentials Here..."))}}]),n}(i.a.Component),Ze={updateStudents:J,updateSPIData:z},$e=Object(y.b)((function(e){return{currentIteration:e.currentIteration,currentProject:e.currentProject,students:e.students,spiData:e.spiData}}),Ze);!function(e){e[e.LOADING=0]="LOADING",e[e.NOT_GENERATED=1]="NOT_GENERATED",e[e.GENERATED=2]="GENERATED"}(Qe||(Qe={}));var et,tt=$e(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH},a}return Object(p.a)(n,[{key:"threeRands",value:function(e){if(e<3)return[0,0,0];for(var t=[-1,-1,-1],n=0;-1!==t.indexOf(-1);){var a=Math.floor(Math.random()*Math.floor(e));-1===t.indexOf(a)&&(t[n]=a,n+=1)}return t}},{key:"generate",value:function(){var e=this;null===this.props.spiData&&alert("Cannot generate when data has not been loaded from database.");var t=this.props.currentProject.parsedTags;if(void 0===t||0!==t.length){var n={};Object.assign(n,this.props.spiData),this.props.students.forEach((function(a){var r=n[a.wustlKey];void 0===r&&(r={},n[a.wustlKey]=r);var i=r[e.props.currentProject.Name];for(void 0===i&&(i=[],r[e.props.currentProject.Name]=i);i.length<=e.props.currentIteration;)i.push({tasks:[]});var s=e.threeRands(t.length).map((function(e){return t[e]}));i[e.props.currentIteration].tasks=[{name:s[0].tag,count:0},{name:s[1].tag,count:0},{name:s[2].tag,count:0}],console.log(i[i.length-1])})),this.props.updateSPIData(n)}else alert("Cannot generate task assignment when no tasks exist for this project. Add tags to this project on Semester Setup > Change Project.")}},{key:"render",value:function(){var e=this,t=null===this.props.spiData?Qe.LOADING:this.props.students.some((function(t){var n=e.props.spiData[t.wustlKey];if(n){var a=n[e.props.currentProject.Name];if(a)return void 0!==a[e.props.currentIteration]}return!1}))?Qe.GENERATED:Qe.NOT_GENERATED;return i.a.createElement("div",{className:"flex-actions"},i.a.createElement("div",{className:t===Qe.LOADING?"":"hide"},i.a.createElement("h3",null,"The necessary data to display the available actions has not loaded from the database yet. If the database is properly configured and running this page will automatically refresh when the data is loaded.")),i.a.createElement(qe,{buttonTitle:"Generate",description:"This button will generate the HIT assignments for all students. Nothing that is already in the database will be changed, modified, or destroyed by this action. Use this button once for each iteration of each project. This will generate a set of HITs for each student to perform for the requested iteration.",buttonClass:"safe",onClick:function(){e.generate()},display:t===Qe.NOT_GENERATED,loadingState:this.state.loadingStatus}),i.a.createElement(qe,{buttonTitle:"Regenerate",description:"This button will REGENERATE the HIT assignments for all students. This will generate a new list of tasks for each student for this iteration and overwrite them in the database. Only run this if HITs have not already been submitted to MTurk. If they have do not run this or it will be impossible to connect logs generated from MTurk to the student that that log belongs to.",buttonClass:"danger",onClick:function(){e.generate()},display:t===Qe.GENERATED,loadingState:this.state.loadingStatus}))}}]),n}(i.a.Component)),nt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"onClick",value:function(e){this.props.onChange(e)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"toggle-container"},this.props.toggles.map((function(t,n){return i.a.createElement("button",{key:t.text,className:e.props.active===n?"safe toggle active":"safe toggle",onClick:function(){e.onClick(n),t.action&&t.action()}},t.text)})))}}]),n}(i.a.Component),at=(i.a.Component,{updateMTurkMode:Q}),rt=Object(y.b)((function(e){return{mturkMode:e.mturkMode}}),at)(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement(nt,{onChange:function(e){},active:this.props.mturkMode===G.SANDBOX?0:1,toggles:[{text:"Submit to Sandbox MTurk",action:function(){e.props.updateMTurkMode(G.SANDBOX)}},{text:"Submit to Real MTurk",action:function(){e.props.updateMTurkMode(G.REAL)}}]})}}]),n}(i.a.Component)),it=Object(y.b)((function(e){return{balances:e.accountBalances,mturkMode:e.mturkMode}}),{})(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.props.balances===[]&&se.dispatch(X(this.props.mturkMode))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("button",{className:"act basic refresh",onClick:function(){return se.dispatch(X(e.props.mturkMode))}}," Refresh "),i.a.createElement(rt,null),i.a.createElement("table",{className:"component"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"WUSTL Key"),i.a.createElement("th",null,"Balance"),i.a.createElement("th",null,"Ready for Submission"))),i.a.createElement("tbody",null,this.props.balances.sort((function(e,t){var n=parseFloat(e.balance),a=parseFloat(t.balance);return n<=9.99&&a<=9.99?0:n<=9.99?-1:1})).map((function(e){var t=parseFloat(e.balance)>9.99;return i.a.createElement("tr",{key:e.wustlKey},i.a.createElement("th",null,e.wustlKey),i.a.createElement("td",null,e.balance),i.a.createElement("td",{className:t?"ready":"not-ready"},t?"Ready":"Not Ready"))})))))}}]),n}(i.a.Component)),st={updateMTurkMode:Q},ot=Object(y.b)((function(e){return{projects:e.projects,iterations:e.iterations,currentProject:e.currentProject,currentIteration:e.currentIteration,spiData:e.spiData,submitHITData:e.submitHITData,students:e.students,mturkMode:e.mturkMode}}),st)(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={activeTable:0,price:"0.40",errors:new B(["WUSTL Key","Error","Count"],[])},a}return Object(p.a)(n,[{key:"getDiffData",value:function(){var e=this;Y();var t=[],n=new B(this.props.submitHITData.data.header,[]);try{var a=this.props.spiData;return null!==a?this.props.submitHITData.data.values.forEach((function(n){var r=a[n[0]];if(r){var i=r[e.props.currentProject.Name];if(i){var s=i[e.props.currentIteration];if(s){var o=s.tasks.find((function(e){return e.name===n[1]}));if(o)return void t.push([n[0],n[1],""+o.count])}}}t.push(n)})):t=this.props.submitHITData.data.values,n.values=t,n}catch(r){return alert(r),this.props.submitHITData.data}}},{key:"buildURL",value:function(e,t,n){return"".concat(t,"/?wustl_key=").concat(e,"&amp;sandbox=").concat(this.props.mturkMode===G.SANDBOX,"&amp;project=").concat(this.props.currentProject.Name,"&amp;iteration=").concat(this.props.currentIteration+1,"&amp;tag=").concat(n)}},{key:"buildFromCountNotGiven",value:function(){var e=Object(b.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},this.props.submitHITData.data.values.forEach((function(e){var a=[],r=e[0],i=e.slice(1),s={};if(i.forEach((function(e){s[e]=0})),n.props.spiData){var o=n.props.spiData[r];if(o){var c=o[n.props.currentProject.Name];if(c){var u=c[n.props.currentIteration];u&&i.forEach((function(e){var t=u.tasks.find((function(t){return t.name===e}));t&&(s[e]=t.count)}))}}}var l=n.props.students.find((function(e){return e.wustlKey===r}));console.log(r),l&&i.forEach((function(e){a.push({count:Math.max(0,3-s[e]),url:n.buildURL(l.wustlKey,l.url,e),price:n.state.price})})),t[r]=a,console.log(a)})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildFromCountGiven",value:function(){var e=Object(b.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},this.props.submitHITData.data.values.forEach((function(e){var a=t[e[0]];void 0===a&&(a=[],t[e[0]]=a);var r=n.props.students.find((function(t){return t.wustlKey===e[0]}));r&&a.push({count:parseInt(e[2]),url:n.buildURL(r.wustlKey,r.url,e[1]),price:n.state.price})})),console.log(t),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"buildURLS",value:function(){return this.props.submitHITData.dataType===F.COUNT_GIVEN?this.buildFromCountGiven():this.buildFromCountNotGiven()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("button",{className:"refresh danger",onClick:Object(b.a)(v.a.mark((function t(){var n,a,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.buildURLS();case 2:return n=t.sent,t.next=5,L.uploadHits(n,e.props.mturkMode,e.props.currentProject.Name);case 5:a=t.sent,e.state.errors.resetValues(),r=0;case 8:if(!(r<a.length)){t.next=16;break}return t.next=11,a[r];case 11:"error"in(i=t.sent)&&((s=e.state.errors.findFirstEntry([{index:0,expectedValue:i.wustlKey},{index:1,expectedValue:i.code}]))?s[s.length-1]=""+(parseInt(s[s.length-1])+1):e.state.errors.values.push([i.wustlKey,i.code,i.error,"1"]));case 13:r++,t.next=8;break;case 16:case"end":return t.stop()}}),t)})))}," Submit Hits "),i.a.createElement(rt,null),i.a.createElement(nt,{onChange:function(t){e.setState({activeTable:t})},toggles:[{text:"Original Assignments"},{text:"Remaining Assignments"}],active:0}),i.a.createElement("div",{className:"payment-input"},i.a.createElement("label",null,"Payout per HIT:"),i.a.createElement("input",{type:"number",value:this.state.price,onChange:function(t){return e.setState({price:parseFloat(t.target.value).toFixed(2)})},min:.05,max:.95,step:.05})),0===this.state.activeTable?i.a.createElement(ye,null):i.a.createElement(be,{data:this.getDiffData()}),i.a.createElement("div",null,i.a.createElement("h3",null,"Errors for submission:"),i.a.createElement(be,{data:this.state.errors})))}}]),n}(i.a.Component)),ct=Object(y.b)((function(e){return{projects:e.projects,iterations:e.iterations,currentProject:e.currentProject,currentIteration:e.currentIteration,spiData:e.spiData,students:e.students}}),{})(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"status-container"},i.a.createElement("button",{className:"status-update safe right",onClick:Object(b.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:L.cancelHits();case 1:case"end":return e.stop()}}),e)})))},"Cancel"),i.a.createElement("h2",null,"Cancel all HITs."),i.a.createElement("p",null,"Cancels all live hits for all individuals listed in the current credentials file."))}}]),n}(i.a.Component)),ut=Object(y.b)((function(e){return{currentIteration:e.currentIteration,currentProject:e.currentProject}}),{})(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH},a}return Object(p.a)(n,[{key:"download",value:function(){var e=Object(b.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({loadingStatus:we.LOADING,errorString:void 0}),e.next=4,Re(this.props.currentProject.Name,t);case 4:"s3Key"in(n=e.sent)&&"localFileName"in n?((a=document.createElement("a")).style.display="none",document.body.appendChild(a),a.href=n.s3Key,a.setAttribute("download",n.localFileName),a.click(),window.URL.revokeObjectURL(a.href),document.body.removeChild(a),this.setState({loadingStatus:we.SUCCESS})):this.setState({loadingStatus:we.ERROR,errorString:"Error while downloading files: "+JSON.stringify(n)}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingStatus:we.ERROR,errorString:"An error occurred during the download: ".concat(e.t0.toString())});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(qe,{buttonTitle:"Download All Logs for ".concat(this.props.currentProject.Name," project, iteration ").concat(this.props.currentIteration,"."),description:"Downloads all logs for the currently selected project and iteration. This is meant for collecting logs for hits following a successful HIT deployment to MTurk.",buttonClass:"safe",onClick:function(){return e.download(e.props.currentIteration)},display:!0,loadingState:this.state.loadingStatus,error:this.state.errorString}))}}]),n}(i.a.Component)),lt=n(44),pt={updateMTurkMode:Q},dt=Object(y.b)((function(e){return{projects:e.projects,iterations:e.iterations,currentProject:e.currentProject,currentIteration:e.currentIteration,spiData:e.spiData,submitHITData:e.submitHITData,students:e.students,mturkMode:e.mturkMode}}),pt)(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH,data:new B([],[])},a}return Object(p.a)(n,[{key:"updateCSVData",value:function(e){this.setState({data:new B(e[0],e.slice(1))})}},{key:"renderFileInput",value:function(){var e=this;return i.a.createElement("form",null,i.a.createElement("input",{type:"file",accept:"text/csv",className:"input-file",name:"csv-input-1",id:"csv-input-1",onChange:function(t){var n,a=null===(n=t.target.files)||void 0===n?void 0:n.item(0);if(a){var r=new FileReader;r.onloadend=function(){r.readyState===FileReader.DONE&&lt(r.result,{},(function(t,n){t?alert("Could not parse file correctly. Error: ".concat(t,".")):e.updateCSVData(n)}))},r.readAsText(a,"utf-8")}}}),i.a.createElement("label",{className:"csv-input",htmlFor:"csv-input-1"},"Input File of HIT Payments here..."))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,this.renderFileInput(),i.a.createElement(qe,{buttonTitle:"Pay",description:"Resolves all of the HITs listed with the action that is provided for it. Valid actions are: approve, bonus, and reject.",buttonClass:"safe",onClick:Object(b.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setState({loadingStatus:we.LOADING,errorString:void 0}),t.next=4,L.payHits(e.state.data);case 4:e.setState({loadingStatus:we.SUCCESS,errorString:void 0}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.setState({loadingStatus:we.ERROR,errorString:t.t0.toString()});case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),display:!0,loadingState:this.state.loadingStatus,error:this.state.errorString}),0===this.state.data.values.length?null:i.a.createElement(be,{data:this.state.data}))}}]),n}(i.a.Component)),ft=Object(y.b)((function(e){return{mturkMode:e.mturkMode}}),{})(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH,data:new B([],[])},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(rt,null),i.a.createElement(qe,{buttonTitle:"Refresh",description:"Gets the current status of all HITs for all accounts.",buttonClass:"basic",onClick:Object(b.a)(v.a.mark((function t(){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loadingStatus:we.LOADING,errorString:void 0}),t.next=3,L.getStatuses(e.props.mturkMode);case 3:n=t.sent,e.setState({data:n,loadingStatus:we.LOADING,errorString:void 0});case 5:case"end":return t.stop()}}),t)}))),display:!0,loadingState:this.state.loadingStatus,error:this.state.errorString}),i.a.createElement(be,{data:this.state.data}))}}]),n}(i.a.Component)),ht=Object(y.b)((function(e){return{currentIteration:e.currentIteration,currentProject:e.currentProject}}),{})(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH},a}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(qe,{buttonTitle:"Disqualify",description:"Disqualifies all mturk workers from the previous iteration.",buttonClass:"info",onClick:Object(b.a)(v.a.mark((function t(){var n,a,r,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.setState({loadingStatus:we.LOADING,errorString:void 0}),!(n=O)){t.next=13;break}return a="/".concat(e.props.currentProject.Name,"/").concat(e.props.currentIteration,"/"),r=new Set,i=n.getLogEntries(a),t.next=9,i;case 9:return t.sent.map((function(e){return e.WorkerID})).forEach((function(e){return r.add(e)})),t.next=12,L.disqualify(e.props.currentProject.Name,r);case 12:e.setState({loadingStatus:we.LOADING});case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),e.setState({loadingStatus:we.ERROR,errorString:t.t0.toString()});case 18:case"end":return t.stop()}}),t,null,[[0,15]])}))),display:!0,loadingState:this.state.loadingStatus,error:this.state.errorString}))}}]),n}(i.a.Component)),mt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).props.tabRef.tab=Object(h.a)(a),a.state={index:0},a}return Object(p.a)(n,[{key:"displayName",value:function(e){var t=this.props.actions.findIndex((function(t){return t.urlName===e}));t>=0&&this.display(t)}},{key:"display",value:function(e){this.setState({index:e})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.display?"tab":"tab hide"},i.a.createElement("div",{className:"tab-content"},i.a.createElement("div",{className:"sidebar"},[].concat(Object(u.a)(this.props.actions.map((function(t,n){return i.a.createElement("button",{className:n===e.state.index?"action active":"action",onClick:function(){return e.display(n)},key:n},t.name)}))),[i.a.createElement("div",{className:"sidebar-filler",key:this.props.actions.length}," ")])),i.a.createElement("div",{className:"output-container"},i.a.createElement("div",{className:"output"},this.props.children?this.props.children:null,this.props.actions.map((function(t,n){return i.a.createElement("div",{className:n===e.state.index?"component-wrapper":"component-wrapper hide",key:n},i.a.createElement("div",{className:"tab-header"},i.a.createElement("h1",null,t.name),i.a.createElement("p",{className:"description"},t.description)),t.component)}))))))}}]),n}(i.a.Component),vt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.SUCCESS},a}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement(mt,{tabRef:this.props.tabRef,display:this.props.display,actions:[{urlName:"clear_db",name:"Clear Database",description:"Deletes all data from the database that is specific to a semester. Retains login data and other non-semester specific data.",component:i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(qe,{buttonTitle:"Clear Database",description:"Clicking this button will delete all data from the database that is not meant to be carried over. This includes: HIT assignments, Student ID to HIT ID mappings and more. Click this button once the semester is completely over and you are ready to clean out all of the old data.",buttonClass:"danger",onClick:function(){},display:!0,loadingState:this.state.loadingStatus})),i.a.createElement($,null))},{urlName:"change_projects",name:"Change Projects",description:"Allows you to view and change projects for this course.",component:i.a.createElement(pe,null)}]})}}]),n}(i.a.Component),bt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement(mt,{tabRef:this.props.tabRef,display:this.props.display,actions:[{urlName:"generate_hits",name:"Generate HITs",description:"Generate HITs for each student. HITs will be generated based on current project and iteration as well as information about which HITs that they have had for previous iterations.",component:i.a.createElement("div",null,i.a.createElement(tt,null),i.a.createElement($,null),i.a.createElement(ye,null))},{urlName:"check_account_balances",name:"Check Account Balances",description:"Checks the account balances for all accounts in the uploaded credentials file.",component:i.a.createElement(it,null)},{urlName:"submit_hits",name:"Submit HITs",description:"Submit hits for the current project and iteration. These hits will be submitted based on the currently generated hits for this project and iteration. You can view those in the table below. If you would like different task assignments then change them here: [insert button that leads to generate hit assignment]",component:i.a.createElement(ot,null)},{urlName:"hit_statuses",name:"HIT Statuses",description:"Display the status of all of the hits that are currently running on MTurk. You can use this information to determine how quickly hits are coming in.",component:i.a.createElement(ft,null)},{urlName:"cancel_hits",name:"Cancel HITs",description:"Allows you to cancel all hits for all accounts listed in the current credentials file.",component:i.a.createElement(ct,null)},{urlName:"download_logs",name:"Download Logs",description:"Allows you to download all logs for a given project and iteration.",component:i.a.createElement(ut,null)},{urlName:"pay_hits",name:"Pay HITs",description:"Allows you to pay hits if given a csv file of payment details.",component:i.a.createElement(dt,null)}]},i.a.createElement(ne,null))}}]),n}(i.a.Component),yt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement(mt,{tabRef:this.props.tabRef,display:this.props.display,actions:[{urlName:"disqualify",name:"Disqualify HITs",description:"Disqualifies workers based on the currently selected project and iteration so they cannot do the next iterations for the same project.",component:i.a.createElement(ht,null)}]},i.a.createElement(ne,null))}}]),n}(i.a.Component),gt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={loadingStatus:we.FRESH},a}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement(mt,{tabRef:this.props.tabRef,display:this.props.display,actions:[{urlName:"load_student_credentials",name:"Load Student Credentials",description:"Load in student credentials if you need to interact with students and/or their Mturk accounts.",component:i.a.createElement("div",null,i.a.createElement(Ye,null),i.a.createElement(qe,{buttonTitle:"Download CSV Template...",description:"This will download a CSV Template that you can then fill out with student credentials. This template has correctly spelt and formatted headers so that there are no validation errors when uploading it later.",buttonClass:"safe",onClick:function(){var e="data:text/plain;charset=utf-8,"+encodeURIComponent("WUSTL Key,GH Pages URL,AWS IAM ID,AWS IAM SECRET\n"),t=document.createElement("a");t.style.display="none",t.href=e,t.download="student-credentials.csv",document.body.appendChild(t),t.click(),t.remove()},display:!0,loadingState:this.state.loadingStatus}))},{urlName:"logout",name:"Logout",description:"Use this to log out of the application.",component:i.a.createElement(Le,null)}]})}}]),n}(i.a.Component);!function(e){e.SessionManagement="session",e.HITManagement="deploy",e.PostHITManagement="post_deployment",e.SemesterManagement="semester_setup"}(et||(et={}));var Et=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).rs=new Array(Object.keys(et).length).fill((function(){return i.a.createRef()}),0,Object.keys(et).length).map((function(e){return e()})),a.state={currentActive:{index:0,navLocation:et.SemesterManagement}},a}return Object(p.a)(n,[{key:"updateActive",value:function(e,t){var n,a,r=this.state.currentActive;r.index!==e&&(null===(n=this.rs[r.index].current)||void 0===n||n.classList.remove("active"),null===(a=this.rs[e].current)||void 0===a||a.classList.add("active"),this.setState({currentActive:{index:e,navLocation:t}}),this.props.onUpdateActive(t))}},{key:"render",value:function(){var e=this;return i.a.createElement("nav",{className:"header"},[i.a.createElement("div",{className:"filler logo",key:-1},"CSE 256")].concat(Object(u.a)(this.rs.map((function(t,n){var a=n,r=Object.values(et)[a];return i.a.createElement("button",{ref:t,key:a,className:e.props.startNavLocation===r?"active":"",onClick:function(){return e.updateActive(a,r)}},r.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "))})))))}}]),n}(i.a.Component),kt=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"footer"},i.a.createElement("div",{className:"attribution"},"Icons made by\xa0",i.a.createElement("a",{href:"https://www.flaticon.com/authors/google",title:"Google"},"Google"),"\xa0from\xa0",i.a.createElement("a",{href:"https://www.flaticon.com/",title:"Flaticon"},"www.flaticon.com")))}}]),n}(i.a.Component),jt={login:q,logout:W},wt=Object(y.b)((function(e){return{loggedIn:e.loggedIn}}),jt),Ot=function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(e){var a,r;return Object(l.a)(this,n),(r=t.call(this,e)).rs=(a={},Object(c.a)(a,et.SemesterManagement,{tab:void 0}),Object(c.a)(a,et.HITManagement,{tab:void 0}),Object(c.a)(a,et.PostHITManagement,{tab:void 0}),Object(c.a)(a,et.SessionManagement,{tab:void 0}),a),r.state={navLocation:et.SessionManagement},r}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=location.hash;if(""!==t){var n=t.split(".");if(!(n.length>=3)){var a=n[0].slice(1),r=2===n.length?n[1]:"";Object.values(et).includes(a)&&this.setState({navLocation:a},(function(){e.rs[a].tab.displayName(r)}))}}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"app"},i.a.createElement(Et,{startNavLocation:this.state.navLocation,onUpdateActive:function(t){return e.setState({navLocation:t})}}),i.a.createElement(gt,{tabRef:this.rs[et.SessionManagement],display:this.state.navLocation===et.SessionManagement}),i.a.createElement(bt,{tabRef:this.rs[et.HITManagement],display:this.state.navLocation===et.HITManagement}),i.a.createElement(yt,{tabRef:this.rs[et.PostHITManagement],display:this.state.navLocation===et.PostHITManagement}),i.a.createElement(vt,{tabRef:this.rs[et.SemesterManagement],display:this.state.navLocation===et.SemesterManagement}),i.a.createElement(kt,null))}}]),n}(i.a.Component),Tt=wt(function(e){Object(d.a)(n,e);var t=Object(f.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;console.log("mounted"),Pe("","").then((function(t){t?(console.log("login"),e.props.login()):(console.log("logout"),e.props.logout())}),(function(t){console.log(t),e.props.logout()})).catch((function(t){console.log("logout"),console.log(t),e.props.logout()}))}},{key:"render",value:function(){return this.props.loggedIn===_.UNATTEMPTED?i.a.createElement("div",{className:"app splash"}):this.props.loggedIn===_.SUCCEEDED?i.a.createElement(Ot,null):i.a.createElement("div",{className:"app"},i.a.createElement(He,null))}}]),n}(i.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(y.a,{store:se},i.a.createElement(Tt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[105,1,2]]]);
//# sourceMappingURL=main.5495785f.chunk.js.map